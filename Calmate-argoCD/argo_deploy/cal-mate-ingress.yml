apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: cal-mate-ingress-db
  annotations:
    # ê¸°ë³¸ì ìœ¼ë¡œ NGINX Ingress ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ëª¨ë“  HTTP íŠ¸ë˜í”½ì„ HTTPSë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•œë‹¤.
    # ì´ ì„¤ì •ì„ "false"ë¡œ ì§€ì •í•˜ë©´ HTTP ìš”ì²­ì„ HTTPSë¡œ ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.
    # ê°œë°œ í™˜ê²½ì´ë‚˜ SSL/TLSê°€ í•„ìš” ì—†ëŠ” ìƒí™©ì—ì„œ ìœ ìš©í•˜ë‹¤.
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
    # ë§¤ì¹­ëœ ê²½ë¡œì—ì„œ /boot ë¶€ë¶„ì„ ì œê±°í•˜ê³  ë‚˜ë¨¸ì§€ ë¶€ë¶„ë§Œ ë°±ì—”ë“œ ì„œë¹„ìŠ¤ë¡œ ì „ë‹¬í•œë‹¤.
    nginx.ingress.kubernetes.io/rewrite-target: /$2
    # ğŸ”¥ ì—…ë¡œë“œ ìš©ëŸ‰ ìƒí•œ (ì˜ˆ: 20MB)
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
spec:
  # ì‚¬ìš©í•  Ingress ì»¨íŠ¸ë¡¤ëŸ¬ì˜ í´ë˜ìŠ¤ë¥¼ ì§€ì •. ì—¬ê¸°ì„œëŠ” NGINX Ingress ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •
  ingressClassName: nginx  
  rules:
  - http:
      paths:
      - path: /()(.*)
        # rewriterì™€ ê´€ë ¨ëœ ì‚¬ì´íŠ¸ ì£¼ì†Œ: https://kubernetes.github.io/ingress-nginx/examples/rewrite/
        # ImplementationSpecificì€ Ingress ì»¨íŠ¸ë¡¤ëŸ¬ì˜ êµ¬í˜„ì— ë”°ë¼ ê²½ë¡œ ë§¤ì¹­ ë°©ì‹ì´ ê²°ì •ëœë‹¤.
        # NGINX Ingress Controllerì˜ ê²½ìš°, ì •ê·œ í‘œí˜„ì‹ì„ í¬í•¨í•œ ë” ìœ ì—°í•œ ë¼ìš°íŒ… ê·œì¹™ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
        # ì´ëŠ” Prefixë‚˜ Exactë³´ë‹¤ ë” ë³µì¡í•œ ê²½ë¡œ ë§¤ì¹­ì„ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.
        # ì˜ˆ: /, /about, /users ë“±
        pathType: ImplementationSpecific
        backend:
          service:
            name: cal-mate-front-ser
            port: 
              number: 8002
      - path: /back(/|$)(.*)
        # ì—¬ê¸°ì„œë„ ImplementationSpecificì„ ì‚¬ìš©í•˜ì—¬ /bootë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ê²½ë¡œë¥¼ ë§¤ì¹­í•œë‹¤.
        # (/|$)ëŠ” /boot ë‹¤ìŒì— /ê°€ ì˜¤ê±°ë‚˜ ë¬¸ìì—´ì´ ëë‚˜ëŠ” ê²½ìš°ë¥¼ ëª¨ë‘ í¬í•¨í•œë‹¤.
        # (.*)ëŠ” ê·¸ ë’¤ì˜ ëª¨ë“  ë¬¸ìì—´ì„ ìº¡ì²˜í•œë‹¤.
        # ì˜ˆ: /boot, /boot/, /boot/plus, /boot/users ë“±
        pathType: ImplementationSpecific
        backend:
          service:
            name: cal-mate-back-ser
            port: 
              number: 8001
      - path: /recommend(/|$)(.*)
              # ì—¬ê¸°ì„œë„ ImplementationSpecificì„ ì‚¬ìš©í•˜ì—¬ /bootë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ê²½ë¡œë¥¼ ë§¤ì¹­í•œë‹¤.
              # (/|$)ëŠ” /boot ë‹¤ìŒì— /ê°€ ì˜¤ê±°ë‚˜ ë¬¸ìì—´ì´ ëë‚˜ëŠ” ê²½ìš°ë¥¼ ëª¨ë‘ í¬í•¨í•œë‹¤.
              # (.*)ëŠ” ê·¸ ë’¤ì˜ ëª¨ë“  ë¬¸ìì—´ì„ ìº¡ì²˜í•œë‹¤.
              # ì˜ˆ: /boot, /boot/, /boot/plus, /boot/users ë“±
        pathType: ImplementationSpecific
        backend:
          service: 
            name: fourth-project-ai-service
            port: 
              number: 8000
